package com.helospark.financialdata.util;

import java.util.LinkedHashMap;
import java.util.List;

import com.helospark.financialdata.service.SymbolAtGlanceProvider;
import com.helospark.financialdata.util.glance.AtGlanceData;

/**
 * Prints more result from the result of ParameterFinderBacktest.
 */
public class StockSummaryPrinter {

    private static final String INPUT = "MANH(317), MTD(304), IDXX(275), MA(257), AAPL(248), QLYS(244), CRVL(242), ADBE(227), FICO(200), CDNS(200), MEDP(198), FIZZ(196), ULTA(192), NVO(189), CHE(154), ORLY(151), LSTR(146), EXPD(142), TREX(138), ASML(136), WAT(128), RHI(126), TPL(124), NVDA(123), DECK(122), MSFT(112), CHKP(110), OFLX(109), BBY(106), AZO(105), LSCC(104), NVR(104), WSM(103), BKNG(103), XLNX(102), VRTX(100), TER(99), MSCI(97), IT(96), ANET(96), RMD(95), SEIC(95), UI(93), ROL(93), SBR(90), FC(89), ODFL(89), MKTX(88), CHRW(85), TXN(83), HBAN(82), KFRC(81), WWE(80), KLAC(79), SAFM(79), LULU(78), LOPE(77), V(76), HD(76), GBL(75), PAYX(75), EW(74), FTNT(74), FDS(73), LPX(73), MELI(72), NSP(72), LRCX(69), VEEV(66), DOOO(65), CORT(65), MNST(65), CTAS(63), MED(63), AMAT(63), TNET(62), PRG(62), LOW(62), PAYC(61), FORR(61), HCA(60), UZA(59), ADP(59), KEYS(59), HDSN(58), LII(58), WINA(57), ATKR(57), DPZ(57), JBL(57), MCK(55), ANSS(55), INTU(54), DDS(54), MUSA(53), SJT(52), DDT(52), SNBR(51), EXPO(50), EPAM(50), NOW(50), HPQ(49), LYB(49), SNPS(49), DVA(49), NRC(49), ALGN(47), SP(47), ACN(47), SWN(46), ABMD(46), VRSN(46), MPWR(46), AMR(45), LLY(45), AVID(44), HRB(44), ABC(44), ADSK(44), NFLX(43), CARG(41), PBT(41), SSTK(41), XPEL(41), CACC(40), ETSY(40), MCFT(40), HCKT(40), BBWI(39), DCP(39), WIRE(38), TDC(37), ASGN(37), SBUX(37), GWW(37), HLF(37), GPC(36), ENPH(35), CHTR(35), ZYXI(34), MLI(34), VLO(34), INVA(34), HSY(33), POWI(33), SPSC(33), PLCE(33), GPI(33), VRSK(33), AN(32), SGU(32), BSIG(32), MSI(32), XPO(32), WNS(31), YUM(31), WST(31), ERF(31), DK(30), GPP(30), CASY(29), PCTY(29), GOL(29), RGR(29), AMN(29), AMGN(29), JKHY(29), IDT(28), CMG(28), HEI-A(28), STLD(28), ARCH(27), CF(27), GOOG(27), MBT(27), ERIE(27), GGG(27), INFY(27), HEI(27), DKS(26), OLN(26), MPX(26), GOOGL(26), BIIB(26), MIME(26), HIBB(26), ROK(26), ATEN(25), FLT(25), OAS(25), PBF(25), RMNI(24), CGNX(24), BMI(24), ALSN(24), AON(24), MTOR(24), WNC(23), ATGE(23), HOLX(23), META(23), HCC(23), CPRX(22), UMBF(22), PHM(22), BLDR(22), BBW(21), HQI(21), WTI(21), CVLG(21), MAS(21), URI(21), FUN(21), PCOM(21), IQV(21), SPGI(21), AZPN(21), DQ(20), WSO-B(20), CPRT(20), TJX(20), CSL(20), BCOR(20), NUE(20), EL(19), ISRG(19), REGN(19), CROX(19), GES(19), SBGI(19), CAH(19), USNA(19), COST(19), FAST(18), DFIN(18), NXPI(18), BMY(18), UHAL(18), STX(18), PZZA(18), CLMT(18), AAL(18), RDY(18), LECO(18), WING(17), POOL(17), SFM(17), AZUL(17), EE(17), WAFD(17), EVTC(17), ECOM(17), OVV(17), GNE(17), PAG(17), MCHP(17), TPX(17), TRI(17), LMT(17), BCC(16), SKY(16), TECH(16), SWKS(16), TTEK(16), GIB(16), IIVI(16), TEN(16), ABBV(16), CHH(16), ITW(16), IRMD(16), NBIX(16), TYL(16), KNSL(16), MATX(16), SBH(16), UNP(15), HVT(15), SNP(15), STR(15), ZBRA(15), CAL(15), CAR(15), BPOPM(15), CNO(15), EXP(15), RRD(15), ARW(15), CVCO(14), SRLP(14), BBU(14), NTCT(14), HTA(14), HVT-A(14), CVLT(14), EXLS(14), YELP(14), DSGX(14), BTU(14), RACE(14), PTSI(14), DOOR(14), TXRH(14), KSS(14), TPH(14), KLIC(14), SEAS(14), PSB-PX(14), FIX(14), LYV(13), SHI(13), EXEL(13), MSGN(13), MAN(13), MCO(13), LAZ(13), LOGI(13), AMG(13), EVR(13), VRTV(13), JILL(13), SLAB(12), CE(12), DO(12), SIG(12), WU(12), WW(12), TTGT(12), MRO(12), NAVI(12), CHDN(12), PARR(12), ZTS(12), MTCH(12), TVTY(12), TROW(12), TOL(12), AMD(12), AHT-PI(12), AHT-PD(12), APA(12), CVI(12), C-PJ(12), DFS(11), HOG(11), M(11), ULH(11), SIX(11), GT(11), WSO(11), SKM(11), HWM(11), KR(11), MGM(11), ATUS(11), SUN(11), APOG(11), APPS(11), GBX(11), CRUS(11), CDW(11), ABR(11), ACH(11), RLGY(11), TLK(11), LQDT(11), CNS(11), AHT-PH(11), NGL(11), DISH(11), CRI(11), AHT-PF(11), AHT-PG(11), TTC(11), PTC(11), DBI(11), STON(10), ARCO(10), W(10), DG(10), UMC(10), ACLS(10), CERN(10), EXTR(10), CCRN(10), PSA-PG(10), PSA-PF(10), GCO(10), EAT(10), MXL(10), ACM(10), EME(10), XENT(10), AMP(10), MERC(10), GDDY(10), DENN(10), NKE(10), PTR(10), SF-PD(10), BLMN(10), GMAB(10), YPF(9), TSLA(9), SEE(9), L(9), FNF(9), SLCT(9), BHC(9), ODP(9), SPH(9), EXPI(9), BVH(9), TY(9), SBAC(9), PERI(9), PATK(9), TGT(9), ABG(9), CHS(9), HMHC(9), SENEA(9), SENEB(9), ALK(9), AMC(9), TTD(9), BLBD(9), ARD(9), NDSN(9), QCOM(9), RDNT(9), SITE(9), NICE(9), LIND(9), CMPR(9), UHS(8), HESM(8), R(8), BW(8), SNEX(8), FL(8), UNH(8), HUM(8), MAR(8), NVMI(8), MBI(8), DXC(8), PRGS(8), MKL(8), SYNA(8), ALNY(8), CPRI(8), SCE-PH(8), VGR(8), DMLP(8), GLP(8), GNW(8), PAA(8), INCY(8), LUMN(8), GSM(8), FORM(8), GTN(8), TNL(8), DINO(8), NEX(8), DLR-PJ(8), GNTX(8), AOS(8), NMM(8), PSB-PY(8), SGMS(8), NSSC(8), AMPY(8), LPI(8), SCHN(8), AVGO(8), DS-PB(7), DS-PC(7), DS-PD(7), UTMD(7), VLGEA(7), WOR(7), JWN(7), DLB(7), CEIX(7), SLM(7), CTIC(7), SATS(7), SWBI(7), UNIT(7), CWEN-A(7), WRLD(7), NX(7), FFIV(7), ON(7), MHO(7), UZC(7), CALM(7), RS(7), GTN-A(7), TEAM(7), MSTR(7), SYF(7), MDXG(7), PLAY(7), HSIC(7), WDFC(7), PAM(7), RYAM(7), GPOR(7), JBLU(7), NAV(7), CLS(7), RNR(7), HOUS(7), CSX(7), SIMO(7), MLCO(7), CUTR(7), MNKD(7), AVT(7), QIWI(7), OLED(7), SF-PC(7), C-PK(7), JACK(7), HALO(6), WMS(6), BC(6), F(6), X(6), BBAR(6), ALP-PQ(6), CVGW(6), QRVO(6), FN(6), WRK(6), SLP(6), PMTS(6), UPS(6), EEFT(6), OGN(6), OIS(6), CAKE(6), CRMT(6), VC(6), CAPL(6), MOH(6), BZH(6), MPC(6), MRK(6), HSII(6), OXY(6), TDS(6), WYNN(6), TGI(6), ABT(6), THO(6), PNNT(6), JBHT(6), WTREP(6), REX(6), KELYB(6), FGEN(6), PGR(6), DIOD(6), NGL-PB(6), CYTK(6), PDCE(6), RNG(6), AMCX(6), BERY(6), BNFT(6), CURV(6), CVS(6), SMTC(6), HZNP(6), IDCC(6), PSX(6), NRG(6), BRK-B(6), LPL(6), EQNR(6), IBEX(6), RUTH(6), HLT(6), NVAX(6), DEN(6), SNCY(5), WMT(5), BG(5), E(5), H(5), BDN(5), DIN(5), CL(5), CO(5), AZTA(5), SCSC(5), DHIL(5), ACGL(5), SHW(5), SPLK(5), CRAI(5), DLX(5), GM(5), BKE(5), BKU(5), BLD(5), KT(5), USM(5), ROST(5), LX(5), SPR(5), BOX(5), LESL(5), MGA(5), DSKE(5), STT(5), STZ(5), OSIS(5), VG(5), MBUU(5), TDS-PV(5), JPM-PK(5), EAI(5), CTXS(5), RCII(5), MTL(5), RETA(5), CWEN(5), CDK(5), VMD(5), ALXN(5), XRX(5), TRMB(5), TROX(5), CSCO(5), HSTM(5), BF-A(5), EOS(5), KELYA(5), BRFS(5), TNP(5), AIG(5), VALU(5), CPA(5), LBTYK(5), YUMC(5), ORCL(5), EBAY(5), RPD(5), CTS(5), PNC(5), LFC(5), INSE(5), AIG-PA(5), EBIX(5), PSB-PZ(5), AXL(5), COMM(5), SIRI(5), TFII(5), SABR(5), SKYW(5), OXSQL(5), STLA(5), WIX(5), ACCO(4), ROIC(4), BA(4), A(4), AXON(4), FLR(4), ARCB(4), IBKR(4), BEP(4), CX(4), NTCO(4), EA(4), DKL(4), MYOV(4), FF(4), HUN(4), CRBG(4), ATLC(4), FRC(4), ARGO-PA(4), HY(4), WTM(4), MAX(4), ANDE(4), SON(4), DRQ(4), GIII(4), OC(4), AGYS(4), MGI(4), WTRE(4), ZUMZ(4), ECHO(4), NTNX(4), GTXAP(4), ICL(4), PRFT(4), SHLX(4), PSA-PS(4), PSA-PR(4), PSA-PQ(4), BXC(4), PSA-PH(4), PSA-PL(4), PSA-PK(4), PSA-PJ(4), PSA-PP(4), PSA-PO(4), PSA-PN(4), PSA-PM(4), PAGP(4), NEXA(4), WLKP(4), PTNR(4), TGLS(4), KMB(4), GEO(4), MRC(4), PANW(4), PTVE(4), ENIC(4), TRGP(4), ALTA(4), AFGE(4), CCK(4), MYE(4), ET-PE(4), ET-PD(4), ET-PC(4), HURN(4), AAN(4), RDN(4), UFPI(4), RES(4), GPK(4), CUEN(4), ITRN(4), ADI(4), SR-PA(4), WLYB(4), BPOPN(4), GPRK(4), BF-B(4), PLNT(4), GTS(4), CLR(4), GTX(4), CLW(4), ADMS(4), CMI(4), VTNR(4), AIT(4), CNC(4), CHRD(4), VALE(4), PLTK(4), PFGC(4), TTWO(4), DLR-PK(4), DLR-PL(4), TRN(4), PJT(4), JBSS(4), AKAM(4), CSV(4), OTIS(4), ILMN(4), CVE(4), TRTN-PC(4), TRTN-PD(4), TRTN-PE(4), TRTN-PB(4), PRO(4), SLG-PI(4), MARK(4), CSTM(4), LNT(4), CNBKA(4), ZEUS(4), STGW(4), NTB(4), DAN(4), AMRK(4), WHR(4), JOE(4), WTFCP(4), UTHR(4), AMWD(4), RMBS(4), BPYU(4), HMY(4), LVS(3), HNP(3), CMSD(3), CMSA(3), AM(3), AGNC(3), BJ(3), HPP(3), MSBI(3), BP(3), HNGR(3), BR(3), FLY(3), CC(3), BJRI(3), CI(3), CHKEZ(3), HRI(3), FNV(3), HSC(3), SIC(3), SID(3), CINR(3), BHE(3), BHF(3), SKT(3), EGHT(3), WTS(3), IBRX(3), WVE(3), KD(3), MCD(3), RDS-B(3), WWW(3), RDS-A(3), CVNA(3), USX(3), HZO(3), LU(3), MODV(3), MD(3), MO(3), DSX(3), RGEN(3), CRGY(3), BURL(3), CRD-B(3), STN(3), MIC(3), PRDO(3), OMI(3), KEP(3), SC(3), SD(3), OMAB(3), SM(3), SWX(3), TV(3), EVRI(3), CCSI(3), MMP(3), IEX(3), SHOO(3), GEF-B(3), FBHS(3), MOS(3), ACGLO(3), GEF(3), GEL(3), MFA-PB(3), DOMO(3), LNTH(3), EBS(3), MSB(3), LTRPB(3), VEC(3), MORN(3), OXM(3), TITN(3), TBI(3), ENIA(3), KRA(3), INT(3), EGP(3), USFD(3), ICLR(3), EBR-B(3), GMS(3), TTMI(3), RYAAY(3), SBOW(3), MTDR(3), ACI(3), IPGP(3), AMH-PG(3), RFP(3), AEL(3), PDM(3), DGICB(3), DGICA(3), TMO(3), PFE(3), PFG(3), VRS(3), DXLG(3), OZON(3), USPH(3), ADNT(3), LSXMB(3), ESI(3), ZION(3), LBTYA(3), LBTYB(3), TRV(3), BRKR(3), EVC(3), ANF(3), SIVBP(3), AMED(3), PYPL(3), EXR(3), TWI(3), ASTL(3), HEES(3), CWK(3), ASH(3), MANT(3), DESP(3), DISCK(3), VNOM(3), RYI(3), HFC(3), TSCO(3), NRZ(3), SIRE(3), FCN(3), TSEM(3), UAL(3), AZZ(3), ROCK(3), MLKN(3), HII(3), DAL(3), ROCC(3), WGO(3), LILA(3), HLI(3), HMC(3), POLY(3), GOGO(3), UGP(3), SCS(2), FARO(2), HOV(2), BCO(2), AR(2), BCX(2), AX(2), SABRP(2), NVEC(2), C(2), NTAP(2), BYND(2), ATHM(2), SCPL(2), CW(2), RDUS(2), BBAI(2), STRL(2), CMTL(2), AMZN(2), CHKEL(2), SPLP(2), LITE(2), EC(2), NM-PG(2), HCSG(2), ET(2), DLO(2), NTES(2), BWMX(2), AGNCP(2), AGNCO(2), GL(2), AGNCN(2), GOOS(2), AGRX(2), LCII(2), RICK(2), AGRO(2), RICE(2), AMSWA(2), SLG(2), MSGE(2), IP(2), SONDW(2), MSGS(2), UNFI(2), PCAR(2), BLL(2), BLW(2), PTCT(2), CTIB(2), BMA(2), SAVE(2), SNX(2), MCG(2), BBIO(2), MCY(2), LFMDP(2), BOC(2), SHEL(2), HLNE(2), MT(2), MU(2), ATRS(2), MX(2), OII(2), SQM(2), SPTN(2), ATRI(2), KAR(2), NM(2), DTP(2), SRC(2), UVE(2), LANC(2), MFA(2), UNMA(2), LPLA(2), QDEL(2), SPLP-PA(2), AAON(2), CMRE-PE(2), HAYN(2), SSP(2), GILD(2), PACW(2), FLWS(2), STC(2), STM(2), EQH-PC(2), QD(2), FLXN(2), DUK-PA(2), CNDT(2), OMC(2), IAG(2), SPXC(2), HUBG(2), MDRX(2), RL(2), PACK(2), KEX(2), ABR-PE(2), NETI(2), SB(2), GRBK(2), IIIN(2), TX(2), OPY(2), BYD(2), FWRD(2), LAUR(2), ENTXW(2), PETS(2), YY(2), BATRA(2), CASH(2), BATRK(2), LAWS(2), PLAB(2), MTH(2), EDN(2), GIC(2), OSUR(2), TCI(2), COWNL(2), PRTH(2), TDG(2), ADEA(2), EGY(2), IPI(2), SHYF(2), TEX(2), CHGG(2), CNSL(2), CUBI(2), THC(2), CGC(2), BIPC(2), SMCI(2), ENOV(2), PAC(2), VMI(2), ELF(2), CHD(2), GPS(2), ADV(2), GRUB(2), AEG(2), FCNCO(2), CIT(2), FCNCA(2), ZWS(2), MGLN(2), TKR(2), AFG(2), IVR(2), DOYU(2), AFL(2), VPG(2), RHP(2), PARAA(2), LYTS(2), SSTI(2), PEN(2), PEP(2), DGII(2), CLF(2), XELA(2), CLX(2), CMC(2), CUBI-PF(2), AIV(2), CNA(2), AJG(2), CNI(2), CSGP(2), CHRA(2), LSXMA(2), LSXMK(2), AL-PA(2), XYL(2), PII(2), NEM(2), CHRS(2), NEU(2), XPER(2), TRS(2), GLOP(2), CRK(2), PLXS(2), NIE(2), APH(2), GLRE(2), TLND(2), TPVG(2), ADUS(2), PNC-PP(2), PPD(2), APSG-UN(2), ABST(2), STAA(2), FCFS(2), PRA(2), CYH(2), DISCA(2), AVD(2), BPOP(2), AVY(2), RXT(2), LORL(2), STFC(2), PVG(2), GWRE(2), NRP(2), AYI(2), HGH(2), PWR(2), UAA(2), HIG(2), IHRT(2), JNJ(2), THRM(2), LRN(2), UDR(2), GBLI(2), RUSHB(2), FHI(2), DDI(2), CIGI(2), NYT(2), ATCX(2), HNI(1), SNDL(1), WLL(1), FRTA(1), GMED(1), HON(1), AEHR(1), DGX(1), FLO(1), J(1), NVEE(1), MUFG(1), SLCA(1), LGND(1), MFIC(1), Y(1), HQH(1), BEN(1), CR(1), CS(1), LZB(1), TPGY-UN(1), APAM(1), BFH(1), SHG(1), WPM(1), HEXO(1), FOE(1), FOR(1), GAINM(1), SANM(1), HTH(1), ONTO(1), TBPH(1), SPNT(1), MYRG(1), ACIW(1), ARHS(1), NEGG(1), AXTA(1), HP(1), QNST(1), SCVL(1), DLTR(1), BELFA(1), BELFB(1), GGAL(1), IX(1), ATNI(1), POWL(1), JD(1), BLX(1), KB(1), CACI(1), ARLP(1), COF-PK(1), COF-PI(1), COF-PJ(1), LW(1), STT-PG(1), MET(1), VSTA(1), NS(1), EXPE(1), SSD(1), BRC(1), PM(1), HWCPZ(1), CTOS(1), BSM(1), ATVI(1), ALGT(1), HT-PD(1), EGRX(1), HT-PC(1), HT-PE(1), PGRE(1), IBP(1), CLBT(1), JNPR(1), SYKE(1), EVOP(1), CALX(1), CTRE(1), TT(1), NS-PB(1), MMC(1), CHSCP(1), ERII(1), LXP-PC(1), SYY(1), IIPR-PA(1), TMST(1), WM(1), FOCS(1), WT(1), KKR(1), IIVIP(1), CARS(1), IHC(1), ACGLN(1), IMXI(1), NATH(1), CATM(1), EBR(1), MIGI(1), MSM(1), JPM-PD(1), KOS(1), MTN(1), CHCT(1), CHCO(1), UWMC(1), GIL(1), AUDC(1), PRTA(1), NLY-PG(1), DXCM(1), WDAY(1), CCO(1), IPG(1), VIV(1), TRIP(1), REVG(1), WSBF(1), RBA(1), MGIC(1), EIG(1), AAP(1), XOM(1), TANNL(1), ABB(1), TANNI(1), CFG(1), TPGY(1), IRS(1), ABM(1), CFR(1), SOHU(1), THR(1), KREF(1), VIST(1), ITRI(1), CHK(1), ADM(1), ABEV(1), ELV(1), ADS(1), CHY(1), PBH(1), CIG(1), KYN(1), PBR(1), TCOM(1), EMR(1), TKC(1), VVNT(1), RGP(1), PCN(1), TRMK(1), DBRG-PH(1), DBRG-PI(1), BRBR(1), IVT(1), PLPC(1), SBSW(1), EOG(1), EOI(1), HONE(1), PAYO(1), TRNS(1), HOLI(1), RIG(1), AGX(1), TMX(1), SONY(1), TNC(1), TNK(1), CMA(1), EQC(1), ADMP(1), VNDA(1), VSH(1), AIR(1), GVA(1), MITK(1), RKT(1), GMRE-PA(1), CNQ(1), CNX(1), MTBCP(1), TARO(1), VNET(1), PHI(1), ESE(1), TPR(1), TRTN(1), COP(1), HMLP(1), NGL-PC(1), ETD(1), RMR(1), IART(1), NEP(1), CPE(1), CPG(1), HKIB(1), VVI(1), GLOP-PB(1), FTCH(1), IRWD(1), SIGA(1), VTRU(1), TSM(1), CRL(1), TTI(1), PLD(1), XNCR(1), SGEN(1), EXK(1), APR(1), PLYA(1), CUZ(1), GHLD(1), THWWW(1), FELE(1), PFPT(1), ASR(1), GDEN(1), MCRI(1), HAE(1), MANU(1), ABTX(1), PRI(1), FIVE(1), HBANO(1), PSB(1), NOK(1), DISCB(1), NUTX(1), NPK(1), EMBC(1), CBRE(1), JHX(1), HEP(1), COLL(1), AXP(1), WCN(1), PBPB(1), AMRC(1), WEX(1), LEAP(1), BIO-B(1), UBS(1), DAO(1), PSTH(1), FANG(1), DBX(1), THRY(1), HTLD(1), DCI(1), OXSQZ(1), CGBD(1), SAM(1), ESTE(1), SAIA(1)";
    private static final List<String> COLUMNS_TO_PRINT = List.of("pe", "trailingPeg:tpeg", "altman", "roic", "roe", "dtoe", "grMargin:grm", "opCMargin:opm", "shareCountGrowth:shareG",
            "price10Gr:grow", "fvCalculatorMoS:mos");

    public static void main(String[] args) throws IllegalArgumentException, IllegalAccessException, NoSuchFieldException, SecurityException {
        printStockSummary(INPUT);
    }

    public static void printStockSummary(String input) throws IllegalAccessException, NoSuchFieldException {
        String[] stocks = input.split(", ");

        SymbolAtGlanceProvider symbolAtGlanceProvider = new SymbolAtGlanceProvider();
        LinkedHashMap<String, AtGlanceData> data = symbolAtGlanceProvider.getSymbolCompanyNameCache();

        System.out.printf("%-15s\t", "stock");
        for (var column : COLUMNS_TO_PRINT) {
            String dataToPrint = column;
            if (column.contains(":")) {
                dataToPrint = column.split(":")[1];
            }
            System.out.print(dataToPrint + "\t");
        }
        System.out.println();

        for (var stock : stocks) {
            String ticker = stock.substring(0, stock.indexOf("("));
            AtGlanceData atGlance = data.get(ticker);
            if (atGlance != null) {
                System.out.printf("%-15s\t", stock);

                for (var column : COLUMNS_TO_PRINT) {
                    System.out.printf("%.2f\t", getFieldAsDouble(atGlance, column));
                }
                System.out.printf("%.1f\t", atGlance.marketCapUsd / 1000.0);
                System.out.printf("%s", atGlance.companyName);
                System.out.println();
            }
        }
    }

    public static Double getFieldAsDouble(AtGlanceData atGlance, String column) throws IllegalAccessException, NoSuchFieldException {
        if (column.contains(":")) {
            column = column.split(":")[0];
        }
        Object value = AtGlanceData.class.getField(column).get(atGlance);

        if (value.getClass().equals(Double.class)) {
            return (Double) value;
        } else if (value.getClass().equals(Float.class)) {
            return ((Float) value).doubleValue();
        } else if (value.getClass().equals(Byte.class)) {
            return ((Byte) value).doubleValue();
        } else if (value.getClass().equals(Integer.class)) {
            return ((Integer) value).doubleValue();
        } else if (value.getClass().equals(Short.class)) {
            return ((Short) value).doubleValue();
        } else {
            throw new RuntimeException("Unknown type");
        }
    }

}
